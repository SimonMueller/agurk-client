(this["webpackJsonpagurk-client"]=this["webpackJsonpagurk-client"]||[]).push([[0],{32:function(e,n,t){e.exports=t(50)},49:function(e,n,t){},50:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),u=t(19),i=t.n(u),c=t(9),o=t(11),l=t(24),s=t(25),d=t(1),m=t(2),f=t(10);function p(){var e=Object(m.a)(["\n  all: unset;\n  cursor: pointer;\n"]);return p=function(){return e},e}function E(){var e=Object(m.a)(["\n  display: inline-block;\n  font-size: 1em;\n  height: 3em;\n  padding: 0.75em;\n  width: 100%;\n  background-color: transparent;\n  border: 2px solid ",";\n  font-weight: bold;\n  color: ",";\n\n  &:hover {\n    background-color: ",";\n    color: white;\n    cursor: pointer;\n  }\n"]);return E=function(){return e},e}var b=d.b.button(E(),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.primary})),g=d.b.button(p()),v=t(21),y=t.n(v),O=t(29),h=t(30),T=t.n(h);function R(e,n){return{type:"AUTHENTICATE_WITH_TOKEN",token:e,subject:n}}function j(e){return{type:"UNAUTHENTICATE_WITH_ERROR",message:e}}function S(e){return{type:"AUTHENTICATION_ERROR",message:e}}function C(e){return T()(e).sub}function A(){var e=Object(m.a)(["\n  background-color: ",";\n  padding: 0.5em;\n  width: 100%;\n  color: white;\n  font-weight: bold;\n"]);return A=function(){return e},e}var _=d.b.div(A(),(function(e){return e.theme.colors.error}));function w(){var e=Object(m.a)(["\n  margin-bottom: 1em;\n"]);return w=function(){return e},e}function I(){var e=Object(m.a)(["\n  padding: 0.5em;\n  width: 100%;\n  height: 3em;\n  margin-bottom: 1em;\n  display: block;\n  font-size: 1em;\n"]);return I=function(){return e},e}function N(){var e=Object(m.a)(["\n  max-width: 500px;\n  margin: auto;\n"]);return N=function(){return e},e}var k=d.b.div(N()),L=d.b.input(I()),D=d.b.form(w());var x=Object(c.b)((function(e){return{error:e.authentication.error}}))((function(e){var n=e.dispatch,t=e.error,u=Object(r.useState)(""),i=Object(f.a)(u,2),c=i[0],o=i[1],l=Object(r.useState)(""),s=Object(f.a)(l,2),d=s[0],m=s[1];return a.a.createElement(k,null,a.a.createElement("h2",null,"Login"),a.a.createElement(D,{onSubmit:function(e){var t;n((t={name:c,token:d},function(e){fetch("".concat("https://agurk-server.herokuapp.com","/authenticate"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(){var n=Object(O.a)(y.a.mark((function n(t){var r,a,u;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.ok){n.next=10;break}return n.next=3,t.json();case 3:r=n.sent,a=r.jwt,u=C(r.jwt),e(R(a,u)),e({type:"SET_PLAYER_ID",playerId:u}),n.next=11;break;case 10:e(S("Authentication failed"));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(){return e(S("Could not contact server. Try again later..."))}))})),e.preventDefault()}},a.a.createElement(L,{placeholder:"Player name",id:"name",value:c,onChange:function(e){o(e.currentTarget.value)},type:"text",name:"name",required:!0}),a.a.createElement(L,{placeholder:"Access token",id:"token",value:d,onChange:function(e){m(e.currentTarget.value)},type:"password",name:"token",required:!0}),a.a.createElement(b,{type:"submit"},"Log in")),t&&a.a.createElement(_,null,t))})),M=t(5),P=t(53),Y=t(54);function U(e){return{type:"SET_IS_IN_GAME",isInGame:e}}function W(e){return e.next({name:M.MessageName.START_GAME})}function B(e,n){return e.next({name:M.MessageName.PLAY_CARDS,data:n})}function G(e,n){return e.next({name:M.MessageName.AUTHENTICATE,data:n})}function H(){var e=Object(m.a)(["\n  margin-bottom: 0.5em;\n"]);return H=function(){return e},e}var q=d.b.li(H());function F(e){var n=e.playerIds.map((function(e){return a.a.createElement(q,{key:e},e)}));return a.a.createElement("div",null,a.a.createElement("h2",null,"Players"),a.a.createElement("ul",null,n))}var K=Object(c.b)((function(e){return{playerIds:e.lobby.players}}))((function(e){var n=e.playerIds,t=e.startGame;return a.a.createElement("div",null,a.a.createElement(F,{playerIds:n}),a.a.createElement(b,{type:"button",onClick:t},"Start Game"))})),J=t(3);function z(){var e=Object(m.a)(["\n  width: 100%;\n"]);return z=function(){return e},e}function Q(){var e=Object(m.a)(["\n  border-color: ",";\n  border-width: 2px;\n  border-style: solid;\n  border-radius: 6%;\n  width: 4.75em;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-items: center;\n  margin: auto;\n"]);return Q=function(){return e},e}var V=d.b.div(Q(),(function(e){var n=e.isSelected,t=e.theme;return n?"".concat(t.colors.primary):"white"})),$=d.b.img(z());function X(e){return e.kind===M.JOKER_CARD_KIND?e.color+e.rank:e.suit+e.rank}function Z(e){var n=e.card.color.toLowerCase();return a.a.createElement($,{src:"/agurk-client/images/joker.svg",alt:"joker card of color ".concat(n)})}function ee(e){var n=e.card,t=n.suit.toLowerCase(),r="/agurk-client/images/".concat(n.rank,"-").concat(t,".svg");return a.a.createElement($,{src:r,alt:"card of rank ".concat(n.rank," and suit ").concat(t)})}function ne(){return a.a.createElement(V,{isSelected:!1},a.a.createElement($,{src:"/agurk-client/images/placeholder.svg",alt:"card placeholder"}))}function te(e){var n=e.card,t=e.isSelected,r=void 0!==t&&t;return a.a.createElement(V,{isSelected:r},n.kind===M.JOKER_CARD_KIND?a.a.createElement(Z,{card:n}):a.a.createElement(ee,{card:n}))}function re(){var e=Object(m.a)(["\n  margin-right: -",";\n  margin-bottom: 0.5em;\n\n  @media(min-width: ",") {\n    margin-right: 0.5em;\n  }\n"]);return re=function(){return e},e}function ae(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: 1em;\n  width: calc(100% - ",");\n\n  @media(min-width: ",") {\n    width: 100%;\n  }\n"]);return ae=function(){return e},e}var ue=d.b.div(ae(),"2.75em",(function(e){return e.theme.breakpoints.minWidth})),ie=d.b.div(re(),"2.75em",(function(e){return e.theme.breakpoints.minWidth}));function ce(e){var n=e.cards,t=e.handleSelect,r=n.map((function(e){return a.a.createElement(ie,{key:X(e)},a.a.createElement(g,{onClick:function(){return t(e)}},a.a.createElement(te,{card:e,isSelected:e.isSelected})))}));return a.a.createElement(ue,null,r)}function oe(e){var n=e.handlePlayClick;return a.a.createElement(a.a.Fragment,null,a.a.createElement(b,{type:"button",onClick:n},"Play Cards"))}function le(e){var n=e.playCards,t=e.cardsInHand,u=e.isServerRequestingCards,i=Object(r.useState)([]),c=Object(f.a)(i,2),o=c[0],l=c[1];return Object(r.useEffect)((function(){var e=t.map((function(e){return Object(J.a)({},e,{isSelected:!1})}));l(e)}),[t]),a.a.createElement("div",null,a.a.createElement("h2",null,"Your hand"),a.a.createElement(ce,{cards:o,handleSelect:function(e){l(o.map((function(n){return Object(M.cardEquals)(n,e)?Object(J.a)({},n,{isSelected:!n.isSelected}):n})))}}),u&&a.a.createElement(oe,{handlePlayClick:function(){var e=o.filter((function(e){return e.isSelected}));n(e)}}))}function se(){var e=Object(m.a)(["\n  background-color: ",";\n  color: white;\n"]);return se=function(){return e},e}function de(){var e=Object(m.a)(["\n  background-color: ",";\n  color: white;\n"]);return de=function(){return e},e}function me(){var e=Object(m.a)(["\n  background-color: ",";\n  color: white;\n"]);return me=function(){return e},e}function fe(){var e=Object(m.a)(["\n  background-color: transparent;\n  border-radius: 0.25em;\n  font-size: 0.7em;\n  margin: 0 0.5em;\n  padding: 0.15em 0.25em;\n  font-weight: bold;\n  text-transform: uppercase;\n"]);return fe=function(){return e},e}var pe=d.b.span(fe()),Ee=Object(d.b)(pe)(me(),(function(e){return e.theme.colors.primary})),be=Object(d.b)(pe)(de(),(function(e){return e.theme.colors.accent})),ge=Object(d.b)(pe)(se(),(function(e){return e.theme.colors.error}));function ve(){var e=Object(m.a)(["\n  font-weight: normal;\n"]);return ve=function(){return e},e}function ye(){var e=Object(m.a)(["\n  animation: "," 2s infinite;\n  font-weight: bold;\n"]);return ye=function(){return e},e}function Oe(){var e=Object(m.a)(["\n  text-decoration-line: ",";\n"]);return Oe=function(){return e},e}function he(){var e=Object(m.a)(["\n  0% {\n    opacity: 0.6;\n  }\n\n  50% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0.6;\n  }\n"]);return he=function(){return e},e}var Te=Object(d.c)(he()),Re=d.b.span(Oe(),(function(e){return e.isOut?"line-through":"none"})),je=Object(d.b)(Re)(ye(),Te),Se=Object(d.b)(Re)(ve());function Ce(e){var n=e.player,t=n.penalties.reduce((function(e,n){return n.card.rank+e}),0);return a.a.createElement(a.a.Fragment,null,n.isServerRequestingCards?a.a.createElement(je,{isOut:n.isOut},n.id):a.a.createElement(Se,{isOut:n.isOut},n.id),a.a.createElement(be,null,"Penalty"," ",t))}function Ae(){var e=Object(m.a)(["\n  margin-bottom: 0.5em;\n"]);return Ae=function(){return e},e}var _e=d.b.li(Ae());function we(e,n){return Math.sign(e.order-n.order)}function Ie(e){var n=e.players.filter((function(e){return!e.isOut})).sort(we).map((function(e){return a.a.createElement(_e,{key:e.id},a.a.createElement(Ce,{player:e}))}));return 0===n.length?null:a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Players"),a.a.createElement("ol",null,n))}function Ne(e){var n=e.players.filter((function(e){return e.isOut})).map((function(e){return a.a.createElement(_e,{key:e.id},a.a.createElement(Ce,{player:e}))}));return 0===n.length?null:a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Out players"),a.a.createElement("ul",null,n))}function ke(e){var n=e.players;return a.a.createElement("div",null,a.a.createElement(Ie,{players:n}),a.a.createElement(Ne,{players:n}))}var Le,De=t(16);function xe(e,n){return e.filter((function(e){return e.playerId===n}))}function Me(e,n){return e.some((function(e){return e.id===n}))}function Pe(e,n){return e.some((function(e){return e===n}))}function Ye(e,n){return e.filter((function(e){return void 0===n.cards.find((function(n){return Object(M.cardEquals)(e,n)}))}))}function Ue(e,n){return e.playerId===n&&e.valid}function We(e,n){var t;return null===(t=e.find((function(e){return e.id===n})))||void 0===t?void 0:t.reason}function Be(e,n){return e.findIndex((function(e){return e===n.id}))}!function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.BETWEEN_ROUNDS=2]="BETWEEN_ROUNDS",e[e.BETWEEN_CYCLES=3]="BETWEEN_CYCLES",e[e.BEFORE_CYCLE=4]="BEFORE_CYCLE",e[e.IN_CYCLE=5]="IN_CYCLE"}(Le||(Le={}));var Ge={stage:Le.START,playerId:void 0,players:[],validatedTurns:[],cardsInHand:[],isLastCycleOfRound:!1,turnTimeoutInMillis:void 0,turnRetriesLeft:0},He={isGameWinner:!1,isRoundWinner:!1,isCycleHighestTurnPlayer:!1,penalties:[],isOut:!1,isServerRequestingCards:!1,order:-1};function qe(e){var n=e.timeoutInSeconds,t=Object(r.useState)(n),u=Object(f.a)(t,2),i=u[0],c=u[1];return Object(r.useEffect)((function(){c(n)}),[n]),Object(r.useEffect)((function(){var e=setInterval((function(){return i-1<0?clearInterval(e):c(i-1)}),1e3);return function(){return clearInterval(e)}})),a.a.createElement(a.a.Fragment,null,i)}function Fe(){var e=Object(m.a)(["\n  margin-bottom: 0;\n"]);return Fe=function(){return e},e}function Ke(){var e=Object(m.a)(["\n  margin: 0;\n  font-weight: bold;\n"]);return Ke=function(){return e},e}function Je(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-items: baseline;\n"]);return Je=function(){return e},e}var ze=d.b.div(Je()),Qe=d.b.p(Ke()),Ve=d.b.h2(Fe());function $e(e){var n=e.turnTimeoutInSeconds,t=e.turnRetriesLeft;return a.a.createElement(ze,null,a.a.createElement(Ve,null,"Your turn"," "),n&&a.a.createElement(Qe,null,a.a.createElement(qe,{timeoutInSeconds:n})," ","seconds and"," ",t," ",1===t?"retry left":"retries left"))}function Xe(e){var n=e.players.find((function(e){return e.isServerRequestingCards}));return a.a.createElement(Ve,null,null===n||void 0===n?void 0:n.id,"'s turn")}function Ze(e){var n=e.isServerRequestingCards,t=e.players,r=e.turnTimeoutInSeconds,u=e.turnRetriesLeft;return n?a.a.createElement($e,{turnTimeoutInSeconds:r,turnRetriesLeft:u}):a.a.createElement(Xe,{players:t})}function en(e){var n=e.players.filter((function(e){return e.isCycleHighestTurnPlayer})).map((function(e){return e.id}));return 0===n.length?a.a.createElement("h2",null,"No cycle winner"):a.a.createElement(Ve,null,n.join(" and ")," ",1===n.length?"wins the cycle":"win the cycle")}function nn(e){var n=e.players.find((function(e){return e.isRoundWinner}));return a.a.createElement(Ve,null,n?"".concat(n.id," wins the round"):"No round winner")}function tn(e){var n=e.players.find((function(e){return e.isGameWinner}));return a.a.createElement(Ve,null,n?"".concat(n.id," wins the game \ud83c\udf89\ud83c\udf89"):"No game winner")}function rn(e){var n=e.isServerRequestingCards,t=e.players,r=e.turnTimeoutInSeconds,u=e.turnRetriesLeft;switch(e.gameStage){case Le.IN_CYCLE:return a.a.createElement(Ze,{isServerRequestingCards:n,players:t,turnRetriesLeft:u,turnTimeoutInSeconds:r});case Le.BETWEEN_CYCLES:return a.a.createElement(en,{players:t});case Le.BETWEEN_ROUNDS:return a.a.createElement(nn,{players:t});case Le.END:return a.a.createElement(tn,{players:t});default:return null}}function an(){var e=Object(m.a)(["\n  margin-right: 1em;\n  margin-bottom: 1em;\n"]);return an=function(){return e},e}function un(){var e=Object(m.a)(["\n  text-align: center;\n"]);return un=function(){return e},e}function cn(){var e=Object(m.a)(["\n  margin-right: 0.5em;\n  margin-bottom: 0.5em;\n"]);return cn=function(){return e},e}function on(){var e=Object(m.a)(["\n  color: ",";\n"]);return on=function(){return e},e}function ln(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n"]);return ln=function(){return e},e}var sn=d.b.div(ln()),dn=Object(d.b)(sn)(on(),(function(e){return e.theme.colors.muted})),mn=d.b.div(cn()),fn=d.b.div(un()),pn=d.b.div(an());function En(e){return e.playerId+e.valid}function bn(e){return e.cards.map((function(e){return a.a.createElement(mn,{key:X(e)},a.a.createElement(te,{card:e}))}))}function gn(e){var n=e.turn,t=bn(n);return a.a.createElement(pn,null,a.a.createElement(sn,null,t),a.a.createElement(fn,null,a.a.createElement("span",null,n.playerId)))}function vn(e){var n=e.turn,t=bn(n);return a.a.createElement(pn,null,a.a.createElement(dn,null,0===t.length?a.a.createElement(ne,null):t),a.a.createElement(fn,null,a.a.createElement("span",null,n.playerId)),a.a.createElement(fn,null,a.a.createElement(ge,null,n.invalidReason)))}function yn(e){var n=e.turn;return n.valid?a.a.createElement(gn,{turn:n}):a.a.createElement(vn,{turn:n})}function On(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return On=function(){return e},e}var hn=d.b.div(On());function Tn(e){var n=e.turns.reduceRight((function(e,n){return void 0===e.find((function(e){return e.playerId===n.playerId}))?[n].concat(Object(De.a)(e)):e}),[]).map((function(e){return a.a.createElement(yn,{key:En(e),turn:e})}));return a.a.createElement(hn,null,n)}function Rn(){var e=Object(m.a)(["\n  margin-bottom: 0.5em;\n"]);return Rn=function(){return e},e}function jn(){var e=Object(m.a)(["\n  text-align: center;\n"]);return jn=function(){return e},e}var Sn=d.b.div(jn()),Cn=d.b.div(Rn());function An(e,n){return Object(M.compareRanks)(e,n)>0?e:n}function _n(e){var n=e.playedTurns.filter((function(e){return e.valid})).flatMap((function(e){return e.cards})),t=n.length>0?a.a.createElement(te,{card:n.reduce(An)}):a.a.createElement(ne,null);return a.a.createElement("div",null,a.a.createElement(Cn,null,t),a.a.createElement(Sn,null,a.a.createElement(Ee,null,"Highest card")))}function wn(){var e=Object(m.a)(["\n  display: flex;\n  flex-wrap: wrap;\n\n  & > * {\n    margin-right: 1em;\n    margin-bottom: 1em;\n  }\n"]);return wn=function(){return e},e}var In=d.b.div(wn());function Nn(e){return e[e.length-1]}function kn(e){var n=e.playedTurns,t=Object(r.useState)(void 0),u=Object(f.a)(t,2),i=u[0],c=u[1];return Object(r.useEffect)((function(){var e=Nn(n);if(c(e),e&&!e.valid){var t=Nn(n.filter((function(e){return e.valid}))),r=setTimeout((function(){c(t)}),2e3);return function(){return clearTimeout(r)}}}),[n]),i?a.a.createElement(yn,{turn:i}):null}function Ln(e){var n=e.playedTurns;return a.a.createElement(In,null,a.a.createElement(_n,{playedTurns:n}),a.a.createElement(kn,{playedTurns:n}))}function Dn(e){var n=e.playedTurns;return e.isLastCycleOfRound?a.a.createElement(Tn,{turns:n}):a.a.createElement(Ln,{playedTurns:n})}function xn(){var e=Object(m.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 6;\n  grid-row-end: span 1;\n\n  @media(min-width: ",") {\n    grid-column-start: 1;\n    grid-column-end: span 1;\n    grid-row-start: 3;\n    grid-row-end: span 1;\n  }\n"]);return xn=function(){return e},e}function Mn(){var e=Object(m.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 4;\n  grid-row-end: span 1;\n\n  @media(min-width: ",") {\n    grid-column-start: 1;\n    grid-column-end: span 1;\n    grid-row-start: 1;\n    grid-row-end: span 2;\n  }\n"]);return Mn=function(){return e},e}function Pn(){var e=Object(m.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 3;\n  grid-row-end: span 1;\n\n  @media(min-width: ",") {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 3;\n    grid-row-end: span 1;\n  }\n"]);return Pn=function(){return e},e}function Yn(){var e=Object(m.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 2;\n  grid-row-end: span 1;\n\n  @media(min-width: ",") {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 2;\n    grid-row-end: span 1;\n  }\n"]);return Yn=function(){return e},e}function Un(){var e=Object(m.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 1;\n  grid-row-end: span 1;\n\n  @media(min-width: ",") {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 1;\n    grid-row-end: span 1;\n  }\n"]);return Un=function(){return e},e}function Wn(){var e=Object(m.a)(["\n  display: grid;\n  row-gap: 1em;\n\n  @media(min-width: ",") {\n    grid-template-columns: 30% 65%;\n    grid-template-rows: auto auto auto;\n    column-gap: 5%;\n    row-gap: 2em;\n  }\n"]);return Wn=function(){return e},e}var Bn=d.b.div(Wn(),(function(e){return e.theme.breakpoints.minWidth})),Gn=d.b.div(Un(),(function(e){return e.theme.breakpoints.minWidth})),Hn=d.b.div(Yn(),(function(e){return e.theme.breakpoints.minWidth})),qn=d.b.div(Pn(),(function(e){return e.theme.breakpoints.minWidth})),Fn=d.b.div(Mn(),(function(e){return e.theme.breakpoints.minWidth})),Kn=d.b.div(xn(),(function(e){return e.theme.breakpoints.minWidth}));var Jn=Object(c.b)((function(e,n){return{state:{cardsInHand:e.game.cardsInHand,players:e.game.players,stage:e.game.stage,playedTurns:e.game.validatedTurns,playerState:e.game.players.find((function(n){return n.id===e.game.playerId})),playCards:function(e){return n.serverApi.sendPlayCards(e)},isLastCycleOfRound:e.game.isLastCycleOfRound,turnTimeoutInSeconds:e.game.turnTimeoutInMillis?e.game.turnTimeoutInMillis/1e3:void 0,turnRetriesLeft:e.game.turnRetriesLeft},playCards:function(e){return n.serverApi.sendPlayCards(e)}}}),(function(e){return{closeGame:function(){e(U(!1))}}}))((function(e){var n=e.state,t=e.playCards,r=e.closeGame;return n.playerState?a.a.createElement(Bn,null,a.a.createElement(Gn,null,a.a.createElement(rn,{gameStage:n.stage,isServerRequestingCards:n.playerState.isServerRequestingCards,players:n.players,turnTimeoutInSeconds:n.turnTimeoutInSeconds,turnRetriesLeft:n.turnRetriesLeft})),a.a.createElement(Hn,null,a.a.createElement(Dn,{playedTurns:n.playedTurns,isLastCycleOfRound:n.isLastCycleOfRound})),a.a.createElement(qn,null,a.a.createElement(le,{isServerRequestingCards:n.playerState.isServerRequestingCards,cardsInHand:n.cardsInHand,playCards:t})),a.a.createElement(Fn,null,a.a.createElement(ke,{players:n.players})),n.stage===Le.END&&a.a.createElement(Kn,null,a.a.createElement(b,{onClick:r},"Return to lobby"))):a.a.createElement("p",null,"Loading game...")}));function zn(e,n,t){e.pipe(Object(P.a)((function(e){return e.name===M.MessageName.REQUEST_AUTHENTICATION}))).subscribe((function(){(function(e){return{sendAuthenticate:G.bind(null,e)}})(e).sendAuthenticate(n)}),(function(){return t(j("Could not authenticate with the game server. Try to login again..."))}))}function Qn(e,n){e.subscribe((function(e){return function(e,n){switch(e.name){case M.MessageName.BROADCAST_LOBBY_PLAYERS:return n({type:"SET_LOBBY_PLAYERS",playerIds:e.data});case M.MessageName.BROADCAST_START_GAME:return n(function(e){return{type:"START_GAME",playerIds:e}}(e.data.players)),n(U(!0));case M.MessageName.BROADCAST_END_GAME:return e.data.isValid?n({type:"END_GAME_SUCCESS",winner:e.data.winner}):n({type:"END_GAME_ERROR",error:e.data.error});case M.MessageName.BROADCAST_START_ROUND:return n(function(e){return{type:"START_ROUND",playerIds:e}}(e.data.players));case M.MessageName.BROADCAST_END_ROUND:return n(function(e,n,t){return{type:"END_ROUND",winner:e,penalties:n,outPlayers:t}}(e.data.winner,e.data.penalties,e.data.outPlayers));case M.MessageName.BROADCAST_START_CYCLE:return n((u=e.data.orderedPlayers,i=e.data.isLastOfRound,{type:"START_CYCLE",orderedPlayerIds:u,isLastOfRound:i}));case M.MessageName.BROADCAST_END_CYCLE:return n((a=e.data.outPlayers,{type:"END_CYCLE",highestTurnPlayerIds:e.data.highestTurnPlayers,outPlayers:a}));case M.MessageName.BROADCAST_PLAYER_TURN:return n({type:"ADD_PLAYER_TURN",turn:e.data});case M.MessageName.AVAILABLE_CARDS_IN_HAND:return n({type:"SET_CARDS_IN_HAND",cards:e.data});case M.MessageName.REQUEST_CARDS:return n((t=e.data.timeoutInMillis,r=e.data.retriesLeft,{type:"REQUEST_CARDS",turnTimeoutInMillis:t,turnRetriesLeft:r}));case M.MessageName.BROADCAST_START_PLAYER_TURN:return n({type:"START_PLAYER_TURN",playerId:e.data})}var t,r,a,u,i}(e,n)}),(function(){return n(j("Could not contact the game server. Try again later..."))}))}var Vn=Object(c.b)((function(e){return{isInGame:e.lobby.isInGame,authenticationToken:e.authentication.token}}))((function(e){var n=e.dispatch,t=e.authenticationToken,u=e.isInGame,i=Object(Y.a)({url:"wss://agurk-server.herokuapp.com",closeObserver:{next:function(e){return n(j(e.reason))}}}),c=Object(r.useState)(i),o=Object(f.a)(c,1)[0],l=function(e){return{sendStartGame:W.bind(null,e),sendPlayCards:B.bind(null,e)}}(o);return Object(r.useEffect)((function(){return Qn(o,n),function(){return o.complete()}}),[o,n]),Object(r.useEffect)((function(){return zn(o,t,n),function(){return o.complete()}}),[o,n,t]),a.a.createElement(a.a.Fragment,null,u?a.a.createElement(Jn,{serverApi:l}):a.a.createElement(K,{startGame:l.sendStartGame}))}));function $n(){var e=Object(m.a)(["\n  margin-bottom: 2em;\n"]);return $n=function(){return e},e}function Xn(){var e=Object(m.a)(["\n  font-size: 1.5em;\n  font-weight: bold;\n\n  &:hover {\n    text-decoration: none;\n  }\n"]);return Xn=function(){return e},e}function Zn(){var e=Object(m.a)(["\n  text-decoration: none;\n  color: white;\n  text-align: center;\n  padding: 0.5em;\n\n  &:hover {\n    text-decoration: underline;\n  }\n"]);return Zn=function(){return e},e}function et(){var e=Object(m.a)(["\n  display: flex;\n  justify-content: start;\n  align-items: center;\n"]);return et=function(){return e},e}function nt(){var e=Object(m.a)(["\n  max-width: 1200px;\n  margin: auto;\n  padding: 0 2em;\n"]);return nt=function(){return e},e}function tt(){var e=Object(m.a)(["\n  background-color: ",";\n"]);return tt=function(){return e},e}var rt=d.b.header(tt(),(function(e){return e.theme.colors.primary})),at=d.b.div(nt()),ut=d.b.nav(et()),it=d.b.a(Zn()),ct=Object(d.b)(it)(Xn()),ot=d.b.main($n());var lt=Object(c.b)((function(e){return{isAuthenticated:e.authentication.isAuthenticated}}))((function(e){var n=e.isAuthenticated;return a.a.createElement(a.a.Fragment,null,a.a.createElement(rt,null,a.a.createElement(ut,null,a.a.createElement(ct,{href:"/agurk-client"},"Agurk"),a.a.createElement(it,{target:"_blank",href:"https://github.com/SimonMueller/agurk-server/blob/master/README.md#rules"},"Read the rules"))),a.a.createElement(at,null,a.a.createElement(ot,null,n?a.a.createElement(Vn,null):a.a.createElement(x,null))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var st={subject:"",isAuthenticated:!1,token:"",error:void 0},dt={players:[],isInGame:!1},mt=Object(o.combineReducers)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"AUTHENTICATE_WITH_TOKEN":return Object(J.a)({},e,{subject:n.subject,isAuthenticated:!0,token:n.token,error:void 0});case"AUTHENTICATION_ERROR":return Object(J.a)({},e,{error:n.message});case"UNAUTHENTICATE_WITH_ERROR":return Object(J.a)({},e,{},st,{error:n.message});default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_PLAYER_ID":return Object(J.a)({},e,{playerId:n.playerId});case"START_GAME":return Object(J.a)({},e,{stage:Le.START,players:n.playerIds.map((function(e){return Object(J.a)({},He,{id:e})}))});case"END_GAME_SUCCESS":return Object(J.a)({},e,{stage:Le.END,players:e.players.map((function(e){return Object(J.a)({},e,{isGameWinner:e.id===n.winner})}))});case"RESET_GAME":return Object(J.a)({},e,{players:e.players.map((function(e){return Object(J.a)({},e,{},He)}))},Ge,{playerId:e.playerId});case"END_GAME_ERROR":return Object(J.a)({},e,{stage:Le.END});case"SET_CARDS_IN_HAND":return Object(J.a)({},e,{cardsInHand:n.cards});case"ADD_PLAYER_TURN":return Object(J.a)({},e,{validatedTurns:[].concat(Object(De.a)(e.validatedTurns),[n.turn]),players:e.players.map((function(e){return Object(J.a)({},e,{isServerRequestingCards:n.turn.playerId!==e.id&&e.isServerRequestingCards})})),cardsInHand:Ue(n.turn,e.playerId)?Ye(e.cardsInHand,n.turn):e.cardsInHand});case"START_ROUND":return Object(J.a)({},e,{stage:Le.BEFORE_CYCLE});case"END_ROUND":return Object(J.a)({},e,{stage:Le.BETWEEN_ROUNDS,players:e.players.map((function(e){return Object(J.a)({},e,{penalties:[].concat(Object(De.a)(e.penalties),Object(De.a)(xe(n.penalties,e.id))),isOut:Me(n.outPlayers,e.id),isRoundWinner:e.id===n.winner})}))});case"START_CYCLE":return Object(J.a)({},e,{players:e.players.map((function(e){return Object(J.a)({},e,{order:Be(n.orderedPlayerIds,e)})})),stage:Le.IN_CYCLE,validatedTurns:[],isLastCycleOfRound:n.isLastOfRound});case"END_CYCLE":return Object(J.a)({},e,{stage:Le.BETWEEN_CYCLES,players:e.players.map((function(e){return Object(J.a)({},e,{isCycleHighestTurnPlayer:Pe(n.highestTurnPlayerIds,e.id),isOut:Me(n.outPlayers,e.id),outReason:We(n.outPlayers,e.id)})}))});case"REQUEST_CARDS":return Object(J.a)({},e,{turnTimeoutInMillis:n.turnTimeoutInMillis,turnRetriesLeft:n.turnRetriesLeft});case"START_PLAYER_TURN":return Object(J.a)({},e,{players:e.players.map((function(e){return Object(J.a)({},e,{isServerRequestingCards:n.playerId===e.id})}))});default:return e}},lobby:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_LOBBY_PLAYERS":return Object(J.a)({},e,{players:n.playerIds});case"SET_IS_IN_GAME":return Object(J.a)({},e,{isInGame:n.isInGame});default:return e}}}),ft=(t(49),{colors:{primary:"#006a4e",muted:"#737373",text:"#000",error:"#ff033e",accent:"#ff2400"},breakpoints:{minWidth:"800px"}}),pt=Object(o.createStore)(mt,Object(s.composeWithDevTools)(Object(o.applyMiddleware)(l.a)));i.a.render(a.a.createElement(c.a,{store:pt},a.a.createElement(d.a,{theme:ft},a.a.createElement(lt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.b72e08e7.chunk.js.map