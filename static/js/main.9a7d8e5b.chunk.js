(this["webpackJsonpagurk-client"]=this["webpackJsonpagurk-client"]||[]).push([[0],{32:function(e,n,t){e.exports=t(50)},49:function(e,n,t){},50:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(19),u=t.n(c),i=t(11),o=t(12),l=t(24),s=t(25),m=t(1),d=t(2),f=t(9);function E(){var e=Object(d.a)(["\n  all: unset;\n  cursor: pointer;\n"]);return E=function(){return e},e}function b(){var e=Object(d.a)(["\n  display: inline-block;\n  font-size: 1em;\n  height: 3em;\n  padding: 0.75em;\n  width: 100%;\n  background-color: transparent;\n  border: 2px solid ",";\n  font-weight: bold;\n  color: ",";\n\n  &:hover {\n    background-color: ",";\n    color: white;\n    cursor: pointer;\n  }\n"]);return b=function(){return e},e}var p=m.b.button(b(),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.primary}),(function(e){return e.theme.colors.primary})),v=m.b.button(E()),y=t(21),g=t.n(y),O=t(29),h=t(30),j=t.n(h);function T(e,n){return{type:"AUTHENTICATE_WITH_TOKEN",token:e,subject:n}}function R(e){return{type:"UNAUTHENTICATE_WITH_ERROR",message:e}}function S(e){return{type:"AUTHENTICATION_ERROR",message:e}}function A(e){return j()(e).sub}function _(){var e=Object(d.a)(["\n  background-color: ",";\n  padding: 0.5em;\n  width: 100%;\n  color: white;\n  font-weight: bold;\n"]);return _=function(){return e},e}var C=m.b.div(_(),(function(e){return e.theme.colors.error}));function I(){var e=Object(d.a)(["\n  margin-bottom: 1em;\n"]);return I=function(){return e},e}function N(){var e=Object(d.a)(["\n  padding: 0.5em;\n  width: 100%;\n  height: 3em;\n  margin-bottom: 1em;\n  display: block;\n  font-size: 1em;\n"]);return N=function(){return e},e}function w(){var e=Object(d.a)(["\n  max-width: 500px;\n  margin: auto;\n"]);return w=function(){return e},e}var k=m.b.div(w()),D=m.b.input(N()),x=m.b.form(I());var L=Object(i.b)((function(e){return{error:e.authentication.error}}))((function(e){var n=e.dispatch,t=e.error,c=Object(r.useState)(""),u=Object(f.a)(c,2),i=u[0],o=u[1],l=Object(r.useState)(""),s=Object(f.a)(l,2),m=s[0],d=s[1];return a.a.createElement(k,null,a.a.createElement("h2",null,"Login"),a.a.createElement(x,{onSubmit:function(e){var t;n((t={name:i,token:m},function(e){fetch("".concat("https://agurk-server.herokuapp.com","/authenticate"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(){var n=Object(O.a)(g.a.mark((function n(t){var r,a,c;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.ok){n.next=10;break}return n.next=3,t.json();case 3:r=n.sent,a=r.jwt,c=A(r.jwt),e(T(a,c)),e({type:"SET_PLAYER_ID",playerId:c}),n.next=11;break;case 10:e(S("Authentication failed"));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(){return e(S("Could not contact server. Try again later..."))}))})),e.preventDefault()}},a.a.createElement(D,{placeholder:"Player name",id:"name",value:i,onChange:function(e){o(e.currentTarget.value)},type:"text",name:"name",required:!0}),a.a.createElement(D,{placeholder:"Access token",id:"token",value:m,onChange:function(e){d(e.currentTarget.value)},type:"password",name:"token",required:!0}),a.a.createElement(p,{type:"submit"},"Log in")),t&&a.a.createElement(C,null,t))})),P=t(5),M=t(53),Y=t(54);function U(e){return{type:"SET_IS_IN_GAME",isInGame:e}}function B(e){return e.next({name:P.MessageName.START_GAME})}function G(e,n){return e.next({name:P.MessageName.PLAY_CARDS,data:n})}function H(e,n){return e.next({name:P.MessageName.AUTHENTICATE,data:n})}function W(){var e=Object(d.a)(["\n  margin-bottom: 0.5em;\n"]);return W=function(){return e},e}var q=m.b.li(W());function F(e){var n=e.playerIds.map((function(e){return a.a.createElement(q,{key:e},e)}));return a.a.createElement("div",null,a.a.createElement("h2",null,"Players"),a.a.createElement("ul",null,n))}var z=Object(i.b)((function(e){return{playerIds:e.lobby.players}}))((function(e){var n=e.playerIds,t=e.startGame;return a.a.createElement("div",null,a.a.createElement(F,{playerIds:n}),a.a.createElement(p,{type:"button",onClick:t},"Start Game"))})),J=t(3);function K(){var e=Object(d.a)(["\n  border: ",";\n"]);return K=function(){return e},e}function Q(){var e=Object(d.a)(["\n  color: ",";\n  border: 1px solid;\n  border-radius: 4px;\n  width: 4em;\n  height: 6em;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-items: center;\n  margin: auto;\n"]);return Q=function(){return e},e}function V(){var e=Object(d.a)(["\n  font-weight: bold;\n  flex-basis: 100%;\n  text-align: center;\n  display: block;\n  font-size: 0.6em;\n  margin: 0;\n"]);return V=function(){return e},e}function $(){var e=Object(d.a)(["\n  font-weight: bold;\n  flex-basis: 100%;\n  text-align: center;\n  display: block;\n  font-size: 2.5em;\n  margin: 0;\n"]);return $=function(){return e},e}var X=m.b.p($()),Z=m.b.p(V()),ee=m.b.div(Q(),(function(e){var n=e.isSelected,t=e.theme;return n?"".concat(t.colors.primary):" ".concat(t.colors.text)})),ne=Object(m.b)(ee)(K(),(function(e){var n=e.theme;return"1px dotted ".concat(n.colors.text)}));function te(e){return e.kind===P.JOKER_CARD_KIND?e.color+e.rank:e.suit+e.rank}function re(e){var n=e.card;return a.a.createElement(a.a.Fragment,null,a.a.createElement(X,null,"J"),a.a.createElement(Z,null,n.color))}function ae(e){var n=e.card;return a.a.createElement(a.a.Fragment,null,a.a.createElement(X,null,n.rank),a.a.createElement(Z,null,n.suit))}function ce(e){var n=e.card,t=e.isSelected,r=void 0!==t&&t;return a.a.createElement(ee,{isSelected:r},n.kind===P.JOKER_CARD_KIND?a.a.createElement(re,{card:n}):a.a.createElement(ae,{card:n}))}function ue(){return a.a.createElement(ne,{isSelected:!1})}function ie(){var e=Object(d.a)(["\n  margin-right: 0.5em;\n  margin-bottom: 0.5em;\n"]);return ie=function(){return e},e}function oe(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: 1em;\n"]);return oe=function(){return e},e}var le=m.b.div(oe()),se=m.b.div(ie());function me(e){var n=e.cards,t=e.handleSelect,r=n.map((function(e){return a.a.createElement(se,{key:te(e)},a.a.createElement(v,{onClick:function(){return t(e)}},a.a.createElement(ce,{card:e,isSelected:e.isSelected})))}));return a.a.createElement(le,null,r)}function de(e){var n=e.handlePlayClick;return a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{type:"button",onClick:n},"Play Cards"))}function fe(e){var n=e.playCards,t=e.cardsInHand,c=e.isServerRequestingCards,u=Object(r.useState)([]),i=Object(f.a)(u,2),o=i[0],l=i[1];return Object(r.useEffect)((function(){var e=t.map((function(e){return Object(J.a)({},e,{isSelected:!1})}));l(e)}),[t]),a.a.createElement("div",null,a.a.createElement("h2",null,"Your hand"),a.a.createElement(me,{cards:o,handleSelect:function(e){l(o.map((function(n){return Object(P.cardEquals)(n,e)?Object(J.a)({},n,{isSelected:!n.isSelected}):n})))}}),c&&a.a.createElement(de,{handlePlayClick:function(){var e=o.filter((function(e){return e.isSelected}));n(e)}}))}function Ee(){var e=Object(d.a)(["\n  background-color: ",";\n  color: white;\n"]);return Ee=function(){return e},e}function be(){var e=Object(d.a)(["\n  background-color: ",";\n  color: white;\n"]);return be=function(){return e},e}function pe(){var e=Object(d.a)(["\n  background-color: ",";\n  color: white;\n"]);return pe=function(){return e},e}function ve(){var e=Object(d.a)(["\n  background-color: transparent;\n  border-radius: 0.25em;\n  font-size: 0.7em;\n  margin: 0 0.5em;\n  padding: 0.15em 0.25em;\n  font-weight: bold;\n  text-transform: uppercase;\n"]);return ve=function(){return e},e}var ye=m.b.span(ve()),ge=Object(m.b)(ye)(pe(),(function(e){return e.theme.colors.primary})),Oe=Object(m.b)(ye)(be(),(function(e){return e.theme.colors.accent})),he=Object(m.b)(ye)(Ee(),(function(e){return e.theme.colors.error}));function je(){var e=Object(d.a)(["\n  font-weight: normal;\n"]);return je=function(){return e},e}function Te(){var e=Object(d.a)(["\n  animation: "," 2s infinite;\n  font-weight: bold;\n"]);return Te=function(){return e},e}function Re(){var e=Object(d.a)(["\n  text-decoration-line: ",";\n"]);return Re=function(){return e},e}function Se(){var e=Object(d.a)(["\n  0% {\n    opacity: 0.6;\n  }\n\n  50% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0.6;\n  }\n"]);return Se=function(){return e},e}var Ae=Object(m.c)(Se()),_e=m.b.span(Re(),(function(e){return e.isOut?"line-through":"none"})),Ce=Object(m.b)(_e)(Te(),Ae),Ie=Object(m.b)(_e)(je());function Ne(e){var n=e.player,t=n.penalties.reduce((function(e,n){return n.card.rank+e}),0);return a.a.createElement(a.a.Fragment,null,n.isServerRequestingCards?a.a.createElement(Ce,{isOut:n.isOut},n.id):a.a.createElement(Ie,{isOut:n.isOut},n.id),a.a.createElement(Oe,null,"Penalty"," ",t))}function we(){var e=Object(d.a)(["\n  font-family: Consolas;\n"]);return we=function(){return e},e}var ke=m.b.span(we());function De(){var e=Object(d.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n"]);return De=function(){return e},e}function xe(){var e=Object(d.a)(["\n  width: 100%;\n"]);return xe=function(){return e},e}var Le=Object(m.b)(v)(xe()),Pe=m.b.div(De());function Me(e){var n=e.children,t=e.collapsedTitle,c=e.title,u=e.isDefaultCollapsed,i=void 0!==u&&u,o=Object(r.useState)(i),l=Object(f.a)(o,2),s=l[0],m=l[1];return a.a.createElement("div",null,a.a.createElement(Le,{onClick:function(){return m(!s)}},a.a.createElement(Pe,null,a.a.createElement("h3",null,s?t:c),a.a.createElement("h3",null,a.a.createElement(ke,null,s?"+":"-")))),!s&&n)}function Ye(){var e=Object(d.a)(["\n  margin-bottom: 0.5em;\n"]);return Ye=function(){return e},e}var Ue=m.b.li(Ye());function Be(e){var n=e.players.map((function(e){return a.a.createElement(Ue,{key:e.id},a.a.createElement(Ne,{player:e}))}));return a.a.createElement(Me,{title:"Players",collapsedTitle:"Players"},a.a.createElement("ul",null,n))}function Ge(){var e=Object(d.a)(["\n  margin-right: 1em;\n  margin-bottom: 1em;\n"]);return Ge=function(){return e},e}function He(){var e=Object(d.a)(["\n  text-align: center;\n"]);return He=function(){return e},e}function We(){var e=Object(d.a)(["\n  margin-right: 0.5em;\n  margin-bottom: 0.5em;\n"]);return We=function(){return e},e}function qe(){var e=Object(d.a)(["\n  color: ",";\n"]);return qe=function(){return e},e}function Fe(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n"]);return Fe=function(){return e},e}var ze=m.b.div(Fe()),Je=Object(m.b)(ze)(qe(),(function(e){return e.theme.colors.muted})),Ke=m.b.div(We()),Qe=m.b.div(He()),Ve=m.b.div(Ge());function $e(e){return e.playerId+e.valid}function Xe(e){var n=e.turn,t=n.cards.map((function(e){return a.a.createElement(Ke,{key:te(e)},a.a.createElement(ce,{card:e}))}));return a.a.createElement(Ve,null,a.a.createElement(ze,null,t),a.a.createElement(Qe,null,a.a.createElement("span",null,n.playerId)))}function Ze(e){var n=e.turn,t=Object(r.useState)(!0),c=Object(f.a)(t,2),u=c[0],i=c[1],o=n.cards.map((function(e){return a.a.createElement(Ke,{key:te(e)},a.a.createElement(ce,{key:te(e),card:e}))}));return Object(r.useEffect)((function(){var e=setTimeout((function(){i(!1)}),2e3);return function(){return clearTimeout(e)}})),u?a.a.createElement(Ve,null,a.a.createElement(Je,null,0===o.length?a.a.createElement(ue,null):o),a.a.createElement(Qe,null,a.a.createElement("span",null,n.playerId)),a.a.createElement(Qe,null,a.a.createElement(he,null,n.invalidReason))):null}function en(e){var n=e.turn;return n.valid?a.a.createElement(Xe,{turn:n}):a.a.createElement(Ze,{turn:n})}function nn(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return nn=function(){return e},e}var tn=m.b.div(nn());function rn(e){var n=e.turns.map((function(e){return a.a.createElement(en,{key:$e(e),turn:e})}));return a.a.createElement(tn,null,n)}function an(){var e=Object(d.a)(["\n  margin-bottom: 0.5em;\n"]);return an=function(){return e},e}function cn(){var e=Object(d.a)(["\n  text-align: center;\n"]);return cn=function(){return e},e}function un(){var e=Object(d.a)(["\n  margin-right: 1em;\n  margin-bottom: 1em;\n"]);return un=function(){return e},e}function on(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return on=function(){return e},e}var ln=m.b.div(on()),sn=m.b.div(un()),mn=m.b.div(cn()),dn=m.b.div(an());function fn(e){var n=e.playedTurns.filter((function(e){return e.valid})).flatMap((function(e){return e.cards})),t=n.length>0?a.a.createElement(ce,{card:n.reduce((function(e,n){return Object(P.compareRanks)(e,n)>0?e:n}))}):a.a.createElement(ue,null);return a.a.createElement(sn,null,a.a.createElement(dn,null,t),a.a.createElement(mn,null,a.a.createElement(ge,null,"Highest card")))}function En(e){var n=e.playedTurns;return a.a.createElement("div",null,a.a.createElement(ln,null,a.a.createElement(sn,null,a.a.createElement(fn,{playedTurns:n})),a.a.createElement(sn,null,a.a.createElement(rn,{turns:n}))))}function bn(){var e=Object(d.a)(["\n  overflow-y: auto;\n  max-height: 25vh;\n"]);return bn=function(){return e},e}var pn=m.b.ul(bn());function vn(e){var n=e.entries.map((function(e){return a.a.createElement("li",null,e.message)}));return a.a.createElement(Me,{title:"Protocol",collapsedTitle:"Protocol"},a.a.createElement(pn,null,n))}var yn,gn=t(10);function On(e,n){return e.filter((function(e){return e.playerId===n}))}function hn(e,n){return e.some((function(e){return e.id===n}))}function jn(e,n){return e.some((function(e){return e===n}))}function Tn(e,n){return e.filter((function(e){return void 0===n.cards.find((function(n){return Object(P.cardEquals)(e,n)}))}))}function Rn(e){return{message:e}}function Sn(e,n){return e.playerId===n&&e.valid}!function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.BETWEEN_ROUNDS=2]="BETWEEN_ROUNDS",e[e.BETWEEN_CYCLES=3]="BETWEEN_CYCLES",e[e.BEFORE_CYCLE=4]="BEFORE_CYCLE",e[e.IN_CYCLE=5]="IN_CYCLE"}(yn||(yn={}));var An={stage:yn.START,playerId:void 0,players:[],validatedTurns:[],cardsInHand:[],turnTimeoutInMillis:void 0,turnRetriesLeft:0,protocol:[]},_n={isGameWinner:!1,isRoundWinner:!1,isCycleHighestTurnPlayer:!1,penalties:[],isOut:!1,isServerRequestingCards:!1};function Cn(e){var n=e.timeoutInSeconds,t=Object(r.useState)(n),c=Object(f.a)(t,2),u=c[0],i=c[1];return Object(r.useEffect)((function(){i(n)}),[n]),Object(r.useEffect)((function(){var e=setInterval((function(){return u-1<0?clearInterval(e):i(u-1)}),1e3);return function(){return clearInterval(e)}})),a.a.createElement(a.a.Fragment,null,u)}function In(){var e=Object(d.a)(["\n  margin: 0;\n  font-weight: bold;\n"]);return In=function(){return e},e}function Nn(){var e=Object(d.a)(["\n  margin: 0;\n"]);return Nn=function(){return e},e}function wn(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-items: baseline;\n"]);return wn=function(){return e},e}function kn(){var e=Object(d.a)(["\n  margin: 2em 0;\n"]);return kn=function(){return e},e}var Dn=m.b.div(kn()),xn=m.b.div(wn()),Ln=m.b.h2(Nn()),Pn=m.b.p(In());function Mn(e){var n=e.turnTimeoutInSeconds,t=e.turnRetriesLeft;return a.a.createElement(xn,null,a.a.createElement(Ln,null,"Your turn"," "),n&&a.a.createElement(Pn,null,a.a.createElement(Cn,{timeoutInSeconds:n})," ","seconds and"," ",t," ",1===t?"retry left":"retries left"))}function Yn(e){var n=e.players.find((function(e){return e.isServerRequestingCards}));return a.a.createElement(Ln,null,null===n||void 0===n?void 0:n.id,"'s turn")}function Un(e){var n=e.isServerRequestingCards,t=e.players,r=e.turnTimeoutInSeconds,c=e.turnRetriesLeft;return n?a.a.createElement(Mn,{turnTimeoutInSeconds:r,turnRetriesLeft:c}):a.a.createElement(Yn,{players:t})}function Bn(e){var n=e.players.filter((function(e){return e.isCycleHighestTurnPlayer})).map((function(e){return e.id}));return 0===n.length?a.a.createElement(Ln,null,"No cycle winner"):a.a.createElement(Ln,null,n.join(", ")," ",1===n.length?"wins the cycle":"win the cycle")}function Gn(e){var n=e.players.find((function(e){return e.isRoundWinner}));return a.a.createElement(Ln,null,n?"".concat(n.id," wins the round"):"No round winner")}function Hn(e){var n=e.players.find((function(e){return e.isGameWinner}));return a.a.createElement(Ln,null,n?"".concat(n.id," wins the game"):"No game winner")}function Wn(e){var n=e.isServerRequestingCards,t=e.players,r=e.turnTimeoutInSeconds,c=e.turnRetriesLeft;switch(e.gameStage){case yn.IN_CYCLE:return a.a.createElement(Dn,null,a.a.createElement(Un,{isServerRequestingCards:n,players:t,turnRetriesLeft:c,turnTimeoutInSeconds:r}));case yn.BETWEEN_CYCLES:return a.a.createElement(Dn,null,a.a.createElement(Bn,{players:t}));case yn.BETWEEN_ROUNDS:return a.a.createElement(Dn,null,a.a.createElement(Gn,{players:t}));case yn.END:return a.a.createElement(Dn,null,a.a.createElement(Hn,{players:t}));default:return null}}function qn(){var e=Object(d.a)(["\n  flex-grow: 1;\n  flex-shrink: 0;\n  flex-basis: 300px;\n  margin-right: 2em;\n"]);return qn=function(){return e},e}function Fn(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return Fn=function(){return e},e}var zn=m.b.div(Fn()),Jn=m.b.div(qn());var Kn=Object(i.b)((function(e,n){return{state:{cardsInHand:e.game.cardsInHand,players:e.game.players,stage:e.game.stage,playedTurns:e.game.validatedTurns,playerState:e.game.players.find((function(n){return n.id===e.game.playerId})),playCards:function(e){return n.serverApi.sendPlayCards(e)},turnTimeoutInSeconds:e.game.turnTimeoutInMillis?e.game.turnTimeoutInMillis/1e3:void 0,turnRetriesLeft:e.game.turnRetriesLeft,protocolEntries:e.game.protocol},playCards:function(e){return n.serverApi.sendPlayCards(e)}}}),(function(e){return{reset:function(){return e({type:"RESET_GAME"})},cancelGame:function(){return e(U(!1))}}}))((function(e){var n=e.state,t=e.playCards,c=e.reset;return Object(r.useEffect)((function(){return c}),[c]),n.playerState?a.a.createElement("div",null,a.a.createElement(Wn,{gameStage:n.stage,isServerRequestingCards:n.playerState.isServerRequestingCards,players:n.players,turnTimeoutInSeconds:n.turnTimeoutInSeconds,turnRetriesLeft:n.turnRetriesLeft}),a.a.createElement(En,{playedTurns:n.playedTurns}),a.a.createElement(fe,{isServerRequestingCards:n.playerState.isServerRequestingCards,cardsInHand:n.cardsInHand,playCards:t}),a.a.createElement(zn,null,a.a.createElement(Jn,null,a.a.createElement(Be,{players:n.players})),a.a.createElement(Jn,null,a.a.createElement(vn,{entries:n.protocolEntries})))):a.a.createElement("p",null,"Loading game...")}));function Qn(e,n,t){e.pipe(Object(M.a)((function(e){return e.name===P.MessageName.REQUEST_AUTHENTICATION}))).subscribe((function(){(function(e){return{sendAuthenticate:H.bind(null,e)}})(e).sendAuthenticate(n)}),(function(){return t(R("Could not authenticate with the game server. Try to login again..."))}))}function Vn(e,n){e.subscribe((function(e){return function(e,n){switch(e.name){case P.MessageName.BROADCAST_LOBBY_PLAYERS:return n({type:"SET_LOBBY_PLAYERS",playerIds:e.data});case P.MessageName.BROADCAST_START_GAME:return n(function(e){return{type:"START_GAME",playerIds:e}}(e.data.players)),n(U(!0));case P.MessageName.BROADCAST_END_GAME:return e.data.isValid?n({type:"END_GAME_SUCCESS",winner:e.data.winner}):n({type:"END_GAME_ERROR",error:e.data.error}),n(U(!1));case P.MessageName.BROADCAST_START_ROUND:return n(function(e){return{type:"START_ROUND",playerIds:e}}(e.data.players));case P.MessageName.BROADCAST_END_ROUND:return n(function(e,n,t){return{type:"END_ROUND",winner:e,penalties:n,outPlayers:t}}(e.data.winner,e.data.penalties,e.data.outPlayers));case P.MessageName.BROADCAST_START_CYCLE:return n({type:"START_CYCLE",orderedPlayerIds:e.data.orderedPlayers});case P.MessageName.BROADCAST_END_CYCLE:return n((a=e.data.outPlayers,{type:"END_CYCLE",highestTurnPlayerIds:e.data.highestTurnPlayers,outPlayers:a}));case P.MessageName.BROADCAST_PLAYER_TURN:return n({type:"ADD_PLAYER_TURN",turn:e.data});case P.MessageName.AVAILABLE_CARDS_IN_HAND:return n({type:"SET_CARDS_IN_HAND",cards:e.data});case P.MessageName.REQUEST_CARDS:return n((t=e.data.timeoutInMillis,r=e.data.retriesLeft,{type:"REQUEST_CARDS",turnTimeoutInMillis:t,turnRetriesLeft:r}));case P.MessageName.BROADCAST_START_PLAYER_TURN:return n({type:"START_PLAYER_TURN",playerId:e.data})}var t,r,a}(e,n)}),(function(){return n(R("Could not contact the game server. Try again later..."))}))}var $n=Object(i.b)((function(e){return{isInGame:e.lobby.isInGame,authenticationToken:e.authentication.token}}))((function(e){var n=e.dispatch,t=e.authenticationToken,c=e.isInGame,u=Object(r.useState)(Object(Y.a)("wss://agurk-server.herokuapp.com")),i=Object(f.a)(u,1)[0],o=function(e){return{sendStartGame:B.bind(null,e),sendPlayCards:G.bind(null,e)}}(i);return Object(r.useEffect)((function(){return Vn(i,n),function(){return i.complete()}}),[i,n]),Object(r.useEffect)((function(){return Qn(i,t,n),function(){return i.complete()}}),[i,n,t]),a.a.createElement(a.a.Fragment,null,c?a.a.createElement(Kn,{serverApi:o}):a.a.createElement(z,{startGame:o.sendStartGame}))}));function Xn(){var e=Object(d.a)(["\n  color: ",";\n  text-decoration: none;\n\n  &:hover {\n    color: ",";\n    text-decoration: underline;\n  }\n"]);return Xn=function(){return e},e}function Zn(){var e=Object(d.a)(["\n  margin-bottom: 2em;\n"]);return Zn=function(){return e},e}function et(){var e=Object(d.a)(["\n  text-align: center;\n  margin-bottom: 2em;\n"]);return et=function(){return e},e}function nt(){var e=Object(d.a)(["\n  display: inline-block;\n  text-decoration: none;\n"]);return nt=function(){return e},e}function tt(){var e=Object(d.a)(["\n  display: flex;\n  justify-content: center;\n"]);return tt=function(){return e},e}function rt(){var e=Object(d.a)(["\n  max-width: 800px;\n  margin: auto;\n  padding: 0 2em;\n"]);return rt=function(){return e},e}function at(){var e=Object(d.a)(["\n  color: white;\n  margin: 0;\n  text-align: center;\n  padding: 0.5em;\n  font-size: 1.5em;\n  font-weight: bold;\n"]);return at=function(){return e},e}function ct(){var e=Object(d.a)(["\n  background-color: ",";\n"]);return ct=function(){return e},e}var ut=m.b.header(ct(),(function(e){return e.theme.colors.primary})),it=m.b.h1(at()),ot=m.b.div(rt()),lt=m.b.nav(tt()),st=m.b.a(nt()),mt=m.b.footer(et()),dt=m.b.main(Zn()),ft=m.b.a(Xn(),(function(e){return e.theme.colors.muted}),(function(e){return e.theme.colors.text}));var Et=Object(i.b)((function(e){return{isAuthenticated:e.authentication.isAuthenticated}}))((function(e){var n=e.isAuthenticated;return a.a.createElement(a.a.Fragment,null,a.a.createElement(ut,null,a.a.createElement(lt,null,a.a.createElement(st,{href:"/agurk-client"},a.a.createElement(it,null,"Agurk")))),a.a.createElement(ot,null,a.a.createElement(dt,null,n?a.a.createElement($n,null):a.a.createElement(L,null)),a.a.createElement(mt,null,a.a.createElement(ft,{target:"_blank",href:"https://github.com/SimonMueller/agurk-server/blob/master/README.md#rules"},"Read the rules"))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var bt={subject:"",isAuthenticated:!1,token:"",error:void 0},pt={players:[],isInGame:!1},vt=Object(o.combineReducers)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"AUTHENTICATE_WITH_TOKEN":return Object(J.a)({},e,{subject:n.subject,isAuthenticated:!0,token:n.token,error:void 0});case"AUTHENTICATION_ERROR":return Object(J.a)({},e,{error:n.message});case"UNAUTHENTICATE_WITH_ERROR":return Object(J.a)({},e,{},bt,{error:n.message});default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_PLAYER_ID":return Object(J.a)({},e,{playerId:n.playerId});case"START_GAME":return Object(J.a)({},e,{stage:yn.START,players:n.playerIds.map((function(e){return Object(J.a)({},_n,{id:e})}))});case"END_GAME_SUCCESS":return Object(J.a)({},e,{stage:yn.END,players:e.players.map((function(e){return Object(J.a)({},e,{isGameWinner:e.id===n.winner})})),protocol:[Rn("".concat(n.winner," wins the game"))].concat(Object(gn.a)(e.protocol))});case"RESET_GAME":return Object(J.a)({},e,{players:e.players.map((function(e){return Object(J.a)({},e,{},_n)}))},An,{playerId:e.playerId});case"END_GAME_ERROR":return Object(J.a)({},e,{stage:yn.END,protocol:[Rn("".concat(n.error.message))].concat(Object(gn.a)(e.protocol))});case"SET_CARDS_IN_HAND":return Object(J.a)({},e,{cardsInHand:n.cards});case"ADD_PLAYER_TURN":return Object(J.a)({},e,{validatedTurns:[].concat(Object(gn.a)(e.validatedTurns),[n.turn]),players:e.players.map((function(e){return Object(J.a)({},e,{isServerRequestingCards:n.turn.playerId!==e.id&&e.isServerRequestingCards})})),cardsInHand:Sn(n.turn,e.playerId)?Tn(e.cardsInHand,n.turn):e.cardsInHand,protocol:n.turn.valid?[Rn("\n                ".concat(n.turn.playerId," plays\n                ").concat(n.turn.cards.length>1?"cards":"card","\n                with\n                ").concat(n.turn.cards.length>1?"ranks":"rank","\n                ").concat(n.turn.cards.map((function(e){return e.rank})).join(", ")))].concat(Object(gn.a)(e.protocol)):e.protocol});case"START_ROUND":return Object(J.a)({},e,{stage:yn.BEFORE_CYCLE});case"END_ROUND":return Object(J.a)({},e,{stage:yn.BETWEEN_ROUNDS,players:e.players.map((function(e){return Object(J.a)({},e,{penalties:[].concat(Object(gn.a)(e.penalties),Object(gn.a)(On(n.penalties,e.id))),isOut:hn(n.outPlayers,e.id),isRoundWinner:e.id===n.winner})})),protocol:[Rn("".concat(n.winner," wins the current round"))].concat(Object(gn.a)(n.penalties.map((function(e){return Rn("".concat(e.playerId," gets a penalty of ").concat(e.card.rank))}))),Object(gn.a)(n.outPlayers.map((function(e){return Rn("".concat(e.id," is out because ").concat(e.reason))}))),Object(gn.a)(e.protocol))});case"START_CYCLE":return Object(J.a)({},e,{stage:yn.IN_CYCLE,validatedTurns:[]});case"END_CYCLE":return Object(J.a)({},e,{stage:yn.BETWEEN_CYCLES,players:e.players.map((function(e){return Object(J.a)({},e,{isCycleHighestTurnPlayer:jn(n.highestTurnPlayerIds,e.id),isOut:hn(n.outPlayers,e.id)})})),protocol:[].concat(Object(gn.a)(n.highestTurnPlayerIds.map((function(e){return Rn("".concat(e," played the highest card in cycle"))}))),Object(gn.a)(n.outPlayers.map((function(e){return Rn("".concat(e.id," is out because ").concat(e.reason))}))),Object(gn.a)(e.protocol))});case"REQUEST_CARDS":return Object(J.a)({},e,{turnTimeoutInMillis:n.turnTimeoutInMillis,turnRetriesLeft:n.turnRetriesLeft});case"START_PLAYER_TURN":return Object(J.a)({},e,{players:e.players.map((function(e){return Object(J.a)({},e,{isServerRequestingCards:n.playerId===e.id})}))});default:return e}},lobby:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_LOBBY_PLAYERS":return Object(J.a)({},e,{players:n.playerIds});case"SET_IS_IN_GAME":return Object(J.a)({},e,{isInGame:n.isInGame});default:return e}}}),yt=(t(49),{colors:{primary:"#006a4e",muted:"#737373",text:"#000",error:"#ff033e",accent:"#ff2400"}}),gt=Object(o.createStore)(vt,Object(s.composeWithDevTools)(Object(o.applyMiddleware)(l.a)));u.a.render(a.a.createElement(i.a,{store:gt},a.a.createElement(m.a,{theme:yt},a.a.createElement(Et,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.9a7d8e5b.chunk.js.map