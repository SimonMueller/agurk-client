(this["webpackJsonpagurk-client"]=this["webpackJsonpagurk-client"]||[]).push([[0],{82:function(e,t,n){e.exports=n(99)},98:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(12),c=n.n(i),u=n(23),o=n(29),l=n(61),s=n(62),d=n(142),m=n(6),f=n(139),E=n(129),p=n(143),g=n(21),v=n(53),h=n(140),y=n(132),b=n(55),O=n.n(b),T=n(63),R=n(64),S=n.n(R);function j(e,t){return{type:"AUTHENTICATE_WITH_TOKEN",token:e,subject:t}}function A(e){return{type:"UNAUTHENTICATE_WITH_ERROR",message:e}}function C(e){return{type:"AUTHENTICATION_ERROR",message:e}}function _(e){return S()(e).sub}var I=n(7);function w(){var e=Object(I.a)(["\n  width: 100%;\n  color: white;\n  background-color: ",";\n"]);return w=function(){return e},e}var N=Object(m.b)(p.a)(w(),(function(e){var t=e.theme,n=e.severity;return t.palette[n].main}));function k(e){var t=e.children,n=e.severity;return a.a.createElement(N,{padding:1,severity:n},t)}var L=Object(u.b)((function(e){return{error:e.authentication.error}}))((function(e){var t=e.dispatch,n=e.error,i=Object(r.useState)(""),c=Object(g.a)(i,2),u=c[0],o=c[1],l=Object(r.useState)(""),s=Object(g.a)(l,2),d=s[0],m=s[1];return a.a.createElement(E.a,{maxWidth:"sm"},a.a.createElement(v.a,{variant:"h1",gutterBottom:!0},"Login"),a.a.createElement(p.a,{marginBottom:2},a.a.createElement("form",{onSubmit:function(e){var n;t((n={name:u,token:d},function(e){fetch("".concat("https://agurk-server.herokuapp.com","/authenticate"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(){var t=Object(T.a)(O.a.mark((function t(n){var r,a,i;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.ok){t.next=10;break}return t.next=3,n.json();case 3:r=t.sent,a=r.jwt,i=_(r.jwt),e(j(a,i)),e({type:"SET_PLAYER_ID",playerId:i}),t.next=11;break;case 10:e(C("Authentication failed"));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(){return e(C("Could not contact server. Try again later..."))}))})),e.preventDefault()}},a.a.createElement(p.a,{marginBottom:1},a.a.createElement(h.a,{variant:"outlined",label:"Player name",id:"name",value:u,onChange:function(e){o(e.target.value)},type:"text",name:"name",fullWidth:!0,margin:"dense",size:"medium",required:!0}),a.a.createElement(h.a,{variant:"outlined",label:"Access token",id:"token",value:d,onChange:function(e){m(e.target.value)},type:"password",name:"token",fullWidth:!0,margin:"dense",size:"medium",required:!0})),a.a.createElement(y.a,{size:"large",fullWidth:!0,variant:"contained",color:"primary",type:"submit"},"Log in"))),n&&a.a.createElement(k,{severity:"error"},a.a.createElement(v.a,{variant:"body1"},n)))})),D=n(11),B=n(136),M=n(141);function P(e){return{type:"SET_IS_IN_GAME",isInGame:e}}function Y(e){return e.next({name:D.MessageName.START_GAME})}function x(e,t){return e.next({name:D.MessageName.PLAY_CARDS,data:t})}function U(e,t){return e.next({name:D.MessageName.AUTHENTICATE,data:t})}var G=n(133),H=n(134),W=n(131);function z(e){var t=e.playerIds.map((function(e){return a.a.createElement(G.a,{key:e},a.a.createElement(H.a,null,e))}));return a.a.createElement("div",null,a.a.createElement(v.a,{variant:"h2",gutterBottom:!0},"Players"),a.a.createElement(W.a,null,t))}var q=Object(u.b)((function(e){return{playerIds:e.lobby.players}}))((function(e){var t=e.playerIds,n=e.startGame;return a.a.createElement("div",null,a.a.createElement(z,{playerIds:t}),a.a.createElement(y.a,{size:"large",fullWidth:!0,variant:"contained",color:"primary",onClick:n},"Start Game"))})),F=n(8),K=n(73),J=n(102);function Q(){var e=Object(I.a)(["\n  height: 100%;\n  width: 100%;\n"]);return Q=function(){return e},e}function V(){var e=Object(I.a)(["\n  border-color: ",";\n  border-width: 2px;\n  border-style: solid;\n  border-radius: 6%;\n  height: ",";\n  width: ",";\n  margin: auto;\n"]);return V=function(){return e},e}var $=Object(m.b)(J.a)(V(),(function(e){var t=e.selected,n=e.theme;return t?"".concat(n.palette.primary.main):"transparent"}),(function(e){return e.height}),(function(e){return e.width})),X=m.b.img(Q());function Z(e){return e.kind===D.JOKER_CARD_KIND?e.color+e.rank:e.suit+e.rank}function ee(e){var t=e.card.color.toLowerCase();return a.a.createElement(X,{src:"/agurk-client/images/joker.svg",alt:"joker card of color ".concat(t)})}function te(e){var t=e.card,n=t.suit.toLowerCase(),r="/agurk-client/images/".concat(t.rank,"-").concat(n,".svg");return a.a.createElement(X,{src:r,alt:"card of rank ".concat(t.rank," and suit ").concat(n)})}function ne(e){return"width"===e?["100%","max-content"]:["max-content","100%"]}function re(e){var t=e.sizeAccordingTo,n=ne(void 0===t?"width":t),r=Object(g.a)(n,2),i=r[0],c=r[1];return a.a.createElement($,{elevation:6,width:i,height:c},a.a.createElement(X,{src:"/agurk-client/images/placeholder.svg",alt:"card placeholder"}))}function ae(e){var t=e.card,n=e.isSelected,r=void 0!==n&&n,i=e.sizeAccordingTo,c=ne(void 0===i?"width":i),u=Object(g.a)(c,2),o=u[0],l=u[1];return a.a.createElement($,{elevation:6,selected:r,width:o,height:l},t.kind===D.JOKER_CARD_KIND?a.a.createElement(ee,{card:t}):a.a.createElement(te,{card:t}))}function ie(){var e=Object(I.a)(["\n  margin-right: -","%;\n  width: ","%;\n"]);return ie=function(){return e},e}function ce(){var e=Object(I.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  width: ","%;\n"]);return ce=function(){return e},e}var ue=Object(m.b)(p.a)(ce(),100-100/7),oe=m.b.div(ie(),100/7,100/7*2);function le(e){var t=e.cards,n=e.handleSelect,r=t.map((function(e){return a.a.createElement(oe,{key:Z(e)},a.a.createElement(K.a,{onClick:function(){return n(e)}},a.a.createElement(ae,{card:e,isSelected:e.isSelected})))}));return a.a.createElement(ue,{marginBottom:1},r)}function se(e){var t=e.handlePlayClick;return a.a.createElement(y.a,{size:"large",fullWidth:!0,variant:"contained",color:"primary",onClick:t},"Play Cards")}function de(e){var t=e.playCards,n=e.cardsInHand,i=e.isServerRequestingCards,c=Object(r.useState)([]),u=Object(g.a)(c,2),o=u[0],l=u[1];return Object(r.useEffect)((function(){var e=n.map((function(e){return Object(F.a)({},e,{isSelected:!1})}));l(e)}),[n]),a.a.createElement("div",null,a.a.createElement(v.a,{variant:"h2",gutterBottom:!0},"Your hand"),a.a.createElement(p.a,{marginBottom:2},a.a.createElement(le,{cards:o,handleSelect:function(e){l(o.map((function(t){return Object(D.cardEquals)(t,e)?Object(F.a)({},t,{isSelected:!t.isSelected}):t})))}})),i&&a.a.createElement(se,{handlePlayClick:function(){var e=o.filter((function(e){return e.isSelected}));t(e)}}))}function me(){var e=Object(I.a)(["\n  background-color: ",";\n  border-radius: 0.25rem;\n  font-size: ",";\n  margin: 0 ","px;\n  padding: 0.15rem 0.25rem;\n  font-weight: bold;\n  text-transform: uppercase;\n  color: white;\n"]);return me=function(){return e},e}var fe=m.b.span(me(),(function(e){var t=e.theme,n=e.severity;return t.palette[n].main}),(function(e){return e.theme.typography.caption.fontSize}),(function(e){return e.theme.spacing(1)}));function Ee(){var e=Object(I.a)(["\n  font-weight: normal;\n"]);return Ee=function(){return e},e}function pe(){var e=Object(I.a)(["\n  animation: "," 2s infinite;\n  font-weight: bold;\n"]);return pe=function(){return e},e}function ge(){var e=Object(I.a)(["\n  text-decoration-line: ",";\n"]);return ge=function(){return e},e}function ve(){var e=Object(I.a)(["\n  0% {\n    opacity: 0.6;\n  }\n\n  50% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0.6;\n  }\n"]);return ve=function(){return e},e}var he=Object(m.c)(ve()),ye=m.b.span(ge(),(function(e){return e.isOut?"line-through":"none"})),be=Object(m.b)(ye)(pe(),he),Oe=Object(m.b)(ye)(Ee());function Te(e){var t=e.player,n=t.penalties.reduce((function(e,t){return t.card.rank+e}),0);return a.a.createElement(a.a.Fragment,null,t.isServerRequestingCards?a.a.createElement(be,{isOut:t.isOut},t.id):a.a.createElement(Oe,{isOut:t.isOut},t.id),a.a.createElement(fe,{severity:"warning"},"Penalty"," ",n))}function Re(e,t){return Math.sign(e.order-t.order)}function Se(e){var t=e.players.filter((function(e){return!e.isOut})).sort(Re).map((function(e){return a.a.createElement(G.a,{key:e.id},a.a.createElement(H.a,null,a.a.createElement(Te,{player:e})))}));return 0===t.length?null:a.a.createElement(a.a.Fragment,null,a.a.createElement(v.a,{variant:"h2",gutterBottom:!0},"Players"),a.a.createElement(W.a,null,t))}function je(e){var t=e.players.filter((function(e){return e.isOut})).map((function(e){return a.a.createElement(G.a,{key:e.id},a.a.createElement(H.a,{secondary:e.outReason},a.a.createElement(Te,{player:e})))}));return t.length?a.a.createElement(W.a,null,t):null}function Ae(e){var t=e.players;return a.a.createElement("div",null,a.a.createElement(Se,{players:t}),a.a.createElement(je,{players:t}))}var Ce,_e=n(44);function Ie(e,t){return e.filter((function(e){return e.playerId===t}))}function we(e,t){return e.some((function(e){return e.id===t}))}function Ne(e,t){return e.some((function(e){return e===t}))}function ke(e,t){return e.filter((function(e){return void 0===t.cards.find((function(t){return Object(D.cardEquals)(e,t)}))}))}function Le(e,t){return e.playerId===t&&e.valid}function De(e,t){var n;return null===(n=e.find((function(e){return e.id===t})))||void 0===n?void 0:n.reason}function Be(e,t){return e.findIndex((function(e){return e===t.id}))}!function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.BETWEEN_ROUNDS=2]="BETWEEN_ROUNDS",e[e.BETWEEN_CYCLES=3]="BETWEEN_CYCLES",e[e.BEFORE_CYCLE=4]="BEFORE_CYCLE",e[e.IN_CYCLE=5]="IN_CYCLE"}(Ce||(Ce={}));var Me={stage:Ce.START,playerId:void 0,players:[],validatedTurns:[],cardsInHand:[],isLastCycleOfRound:!1,turnTimeoutInMillis:void 0,turnRetriesLeft:0},Pe={isGameWinner:!1,isRoundWinner:!1,isCycleHighestTurnPlayer:!1,penalties:[],isOut:!1,isServerRequestingCards:!1,order:-1},Ye=n(135);function xe(e){var t=e.timeoutInSeconds,n=Object(r.useState)(t),i=Object(g.a)(n,2),c=i[0],u=i[1];return Object(r.useEffect)((function(){u(t)}),[t]),Object(r.useEffect)((function(){var e=setInterval((function(){return c-1<0?clearInterval(e):u(c-1)}),1e3);return function(){return clearInterval(e)}})),a.a.createElement(a.a.Fragment,null,c)}function Ue(){var e=Object(I.a)(["\n  font-weight: bold;\n"]);return Ue=function(){return e},e}var Ge=Object(m.b)(v.a)(Ue());function He(e){var t=e.turnTimeoutInSeconds,n=e.turnRetriesLeft;return a.a.createElement(Ye.a,{container:!0,justify:"space-between",alignItems:"baseline"},a.a.createElement(v.a,{variant:"h2"},"Your turn"," "),t&&a.a.createElement(Ge,{variant:"subtitle1"},a.a.createElement(xe,{timeoutInSeconds:t})," ","seconds and"," ",n," ",1===n?"retry left":"retries left"))}function We(e){var t=e.players.find((function(e){return e.isServerRequestingCards}));return a.a.createElement(v.a,{variant:"h2"},null===t||void 0===t?void 0:t.id,"'s turn")}function ze(e){var t=e.isServerRequestingCards,n=e.players,r=e.turnTimeoutInSeconds,i=e.turnRetriesLeft;return t?a.a.createElement(He,{turnTimeoutInSeconds:r,turnRetriesLeft:i}):a.a.createElement(We,{players:n})}function qe(e){var t=e.players.filter((function(e){return e.isCycleHighestTurnPlayer})).map((function(e){return e.id}));return 0===t.length?a.a.createElement("h2",null,"No cycle winner"):a.a.createElement(v.a,{variant:"h2"},t.join(" and ")," ",1===t.length?"wins the cycle":"win the cycle")}function Fe(e){var t=e.players.find((function(e){return e.isRoundWinner}));return a.a.createElement(v.a,{variant:"h2"},t?"".concat(t.id," wins the round"):"No round winner")}function Ke(e){var t=e.players.find((function(e){return e.isGameWinner}));return a.a.createElement(v.a,{variant:"h2"},t?"".concat(t.id," wins the game \ud83c\udf89\ud83c\udf89"):"No game winner")}function Je(e){var t=e.isServerRequestingCards,n=e.players,r=e.turnTimeoutInSeconds,i=e.turnRetriesLeft;switch(e.gameStage){case Ce.IN_CYCLE:return a.a.createElement(ze,{isServerRequestingCards:t,players:n,turnRetriesLeft:i,turnTimeoutInSeconds:r});case Ce.BETWEEN_CYCLES:return a.a.createElement(qe,{players:n});case Ce.BETWEEN_ROUNDS:return a.a.createElement(Fe,{players:n});case Ce.END:return a.a.createElement(Ke,{players:n});default:return null}}function Qe(){var e=Object(I.a)(["\n  text-align: center;\n"]);return Qe=function(){return e},e}function Ve(){var e=Object(I.a)(["\n  height: 100%;\n"]);return Ve=function(){return e},e}var $e=Object(m.b)(Ye.a)(Ve()),Xe=m.b.div(Qe());function Ze(e){return e.playerId+e.valid}function et(e){return e.cards.map((function(e){return a.a.createElement(p.a,{height:"100%",marginRight:1,marginBottom:1,key:Z(e)},a.a.createElement(ae,{sizeAccordingTo:"height",card:e}))}))}function tt(e){var t=e.turn,n=et(t);return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a,{height:"75%",marginBottom:1},a.a.createElement($e,{container:!0,justify:"center"},n)),a.a.createElement(Xe,null,a.a.createElement("span",null,t.playerId)))}function nt(e){var t=e.turn,n=et(t);return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a,{height:"75%",marginBottom:1},a.a.createElement($e,{container:!0,justify:"center"},0===n.length?a.a.createElement(re,{sizeAccordingTo:"height"}):n)),a.a.createElement(Xe,null,a.a.createElement("span",null,t.playerId)),a.a.createElement(Xe,null,a.a.createElement(fe,{severity:"error"},t.invalidReason)))}function rt(e){var t=e.turn;return a.a.createElement(p.a,{height:"100%"},t.valid?a.a.createElement(tt,{turn:t}):a.a.createElement(nt,{turn:t}))}function at(){var e=Object(I.a)(["\n  min-height: 7rem;\n  max-height: 12rem;\n  height: 10vw;\n"]);return at=function(){return e},e}var it=Object(m.b)(p.a)(at());function ct(e){var t=e.turns.reduceRight((function(e,t){return void 0===e.find((function(e){return e.playerId===t.playerId}))?[t].concat(Object(_e.a)(e)):e}),[]).map((function(e){return a.a.createElement(it,{marginRight:1,marginBottom:1,key:Ze(e)},a.a.createElement(rt,{turn:e}))}));return a.a.createElement(Ye.a,{container:!0},t)}function ut(){var e=Object(I.a)(["\n  text-align: center;\n"]);return ut=function(){return e},e}var ot=m.b.div(ut());function lt(e,t){return Object(D.compareRanks)(e,t)>0?e:t}function st(e){var t=e.playedTurns.filter((function(e){return e.valid})).flatMap((function(e){return e.cards})),n=t.length>0?a.a.createElement(ae,{sizeAccordingTo:"height",card:t.reduce(lt)}):a.a.createElement(re,{sizeAccordingTo:"height"});return a.a.createElement(p.a,{height:"100%"},a.a.createElement(p.a,{height:"75%",marginBottom:1},n),a.a.createElement(ot,null,a.a.createElement(fe,{severity:"info"},"Highest card")))}function dt(){var e=Object(I.a)(["\n  min-height: 7rem;\n  max-height: 12rem;\n  height: 10vw;\n"]);return dt=function(){return e},e}var mt=Object(m.b)(p.a)(dt());function ft(e){return e[e.length-1]}function Et(e){var t=e.playedTurns,n=Object(r.useState)(void 0),i=Object(g.a)(n,2),c=i[0],u=i[1];return Object(r.useEffect)((function(){var e=ft(t);if(u(e),e&&!e.valid){var n=ft(t.filter((function(e){return e.valid}))),r=setTimeout((function(){u(n)}),2e3);return function(){return clearTimeout(r)}}}),[t]),c?a.a.createElement(rt,{turn:c}):null}function pt(e){var t=e.playedTurns;return a.a.createElement(Ye.a,{container:!0},a.a.createElement(mt,{marginBottom:1,marginRight:2},a.a.createElement(st,{playedTurns:t})),a.a.createElement(mt,{marginBottom:1},a.a.createElement(Et,{playedTurns:t})))}function gt(e){var t=e.playedTurns;return e.isLastCycleOfRound?a.a.createElement(ct,{turns:t}):a.a.createElement(pt,{playedTurns:t})}function vt(){var e=Object(I.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 6;\n  grid-row-end: span 1;\n\n  @media(min-width: ","px) {\n    grid-column-start: 1;\n    grid-column-end: span 1;\n    grid-row-start: 3;\n    grid-row-end: span 1;\n  }\n"]);return vt=function(){return e},e}function ht(){var e=Object(I.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 4;\n  grid-row-end: span 1;\n\n  @media(min-width: ","px) {\n    grid-column-start: 1;\n    grid-column-end: span 1;\n    grid-row-start: 1;\n    grid-row-end: span 2;\n  }\n"]);return ht=function(){return e},e}function yt(){var e=Object(I.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 3;\n  grid-row-end: span 1;\n\n  @media(min-width: ","px) {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 3;\n    grid-row-end: span 1;\n  }\n"]);return yt=function(){return e},e}function bt(){var e=Object(I.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 2;\n  grid-row-end: span 1;\n\n  @media(min-width: ","px) {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 2;\n    grid-row-end: span 1;\n  }\n"]);return bt=function(){return e},e}function Ot(){var e=Object(I.a)(["\n  grid-column-start: 1;\n  grid-column-end: span 1;\n  grid-row-start: 1;\n  grid-row-end: span 1;\n\n  @media(min-width: ","px) {\n    grid-column-start: 2;\n    grid-column-end: span 1;\n    grid-row-start: 1;\n    grid-row-end: span 1;\n  }\n"]);return Ot=function(){return e},e}function Tt(){var e=Object(I.a)(["\n  display: grid;\n  row-gap: ","px;\n\n  @media(min-width: ","px) {\n    grid-template-columns: 30% 65%;\n    grid-template-rows: auto auto auto;\n    column-gap: 5%;\n    row-gap: 2em;\n  }\n"]);return Tt=function(){return e},e}var Rt=m.b.div(Tt(),(function(e){return e.theme.spacing(2)}),(function(e){return e.theme.breakpoints.values.sm})),St=m.b.div(Ot(),(function(e){return e.theme.breakpoints.values.sm})),jt=m.b.div(bt(),(function(e){return e.theme.breakpoints.values.sm})),At=m.b.div(yt(),(function(e){return e.theme.breakpoints.values.sm})),Ct=m.b.div(ht(),(function(e){return e.theme.breakpoints.values.sm})),_t=m.b.div(vt(),(function(e){return e.theme.breakpoints.values.sm}));var It=Object(u.b)((function(e,t){return{state:{cardsInHand:e.game.cardsInHand,players:e.game.players,stage:e.game.stage,playedTurns:e.game.validatedTurns,playerState:e.game.players.find((function(t){return t.id===e.game.playerId})),playCards:function(e){return t.serverApi.sendPlayCards(e)},isLastCycleOfRound:e.game.isLastCycleOfRound,turnTimeoutInSeconds:e.game.turnTimeoutInMillis?e.game.turnTimeoutInMillis/1e3:void 0,turnRetriesLeft:e.game.turnRetriesLeft},playCards:function(e){return t.serverApi.sendPlayCards(e)}}}),(function(e){return{closeGame:function(){e(P(!1))}}}))((function(e){var t=e.state,n=e.playCards,r=e.closeGame;return t.playerState?a.a.createElement(Rt,null,a.a.createElement(St,null,a.a.createElement(Je,{gameStage:t.stage,isServerRequestingCards:t.playerState.isServerRequestingCards,players:t.players,turnTimeoutInSeconds:t.turnTimeoutInSeconds,turnRetriesLeft:t.turnRetriesLeft})),a.a.createElement(jt,null,a.a.createElement(gt,{playedTurns:t.playedTurns,isLastCycleOfRound:t.isLastCycleOfRound})),a.a.createElement(At,null,a.a.createElement(de,{isServerRequestingCards:t.playerState.isServerRequestingCards,cardsInHand:t.cardsInHand,playCards:n})),a.a.createElement(Ct,null,a.a.createElement(Ae,{players:t.players})),t.stage===Ce.END&&a.a.createElement(_t,null,a.a.createElement(y.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:r},"Return to lobby"))):a.a.createElement("p",null,"Loading game...")}));function wt(e,t,n){e.pipe(Object(B.a)((function(e){return e.name===D.MessageName.REQUEST_AUTHENTICATION}))).subscribe((function(){(function(e){return{sendAuthenticate:U.bind(null,e)}})(e).sendAuthenticate(t)}),(function(){return n(A("Could not authenticate with the game server. Try to login again..."))}))}function Nt(e,t){e.subscribe((function(e){return function(e,t){switch(e.name){case D.MessageName.BROADCAST_LOBBY_PLAYERS:return t({type:"SET_LOBBY_PLAYERS",playerIds:e.data});case D.MessageName.BROADCAST_START_GAME:return t(function(e){return{type:"START_GAME",playerIds:e}}(e.data.players)),t(P(!0));case D.MessageName.BROADCAST_END_GAME:return e.data.isValid?t({type:"END_GAME_SUCCESS",winner:e.data.winner}):t({type:"END_GAME_ERROR",error:e.data.error});case D.MessageName.BROADCAST_START_ROUND:return t(function(e){return{type:"START_ROUND",playerIds:e}}(e.data.players));case D.MessageName.BROADCAST_END_ROUND:return t(function(e,t,n){return{type:"END_ROUND",winner:e,penalties:t,outPlayers:n}}(e.data.winner,e.data.penalties,e.data.outPlayers));case D.MessageName.BROADCAST_START_CYCLE:return t((i=e.data.orderedPlayers,c=e.data.isLastOfRound,{type:"START_CYCLE",orderedPlayerIds:i,isLastOfRound:c}));case D.MessageName.BROADCAST_END_CYCLE:return t((a=e.data.outPlayers,{type:"END_CYCLE",highestTurnPlayerIds:e.data.highestTurnPlayers,outPlayers:a}));case D.MessageName.BROADCAST_PLAYER_TURN:return t({type:"ADD_PLAYER_TURN",turn:e.data});case D.MessageName.AVAILABLE_CARDS_IN_HAND:return t({type:"SET_CARDS_IN_HAND",cards:e.data});case D.MessageName.REQUEST_CARDS:return t((n=e.data.timeoutInMillis,r=e.data.retriesLeft,{type:"REQUEST_CARDS",turnTimeoutInMillis:n,turnRetriesLeft:r}));case D.MessageName.BROADCAST_START_PLAYER_TURN:return t({type:"START_PLAYER_TURN",playerId:e.data})}var n,r,a,i,c}(e,t)}),(function(){return t(A("Could not contact the game server. Try again later..."))}))}var kt=Object(u.b)((function(e){return{isInGame:e.lobby.isInGame,authenticationToken:e.authentication.token}}))((function(e){var t=e.dispatch,n=e.authenticationToken,i=e.isInGame,c=Object(M.a)({url:"wss://agurk-server.herokuapp.com",closeObserver:{next:function(e){return t(A(e.reason))}}}),u=Object(r.useState)(c),o=Object(g.a)(u,1)[0],l=function(e){return{sendStartGame:Y.bind(null,e),sendPlayCards:x.bind(null,e)}}(o);return Object(r.useEffect)((function(){return Nt(o,t),function(){return o.complete()}}),[o,t]),Object(r.useEffect)((function(){return wt(o,n,t),function(){return o.complete()}}),[o,t,n]),a.a.createElement(a.a.Fragment,null,i?a.a.createElement(It,{serverApi:l}):a.a.createElement(q,{startGame:l.sendStartGame}))})),Lt=n(137),Dt=n(138);function Bt(){return a.a.createElement("header",null,a.a.createElement(Lt.a,{position:"static"},a.a.createElement(Dt.a,null,a.a.createElement(y.a,{color:"inherit",href:"./agurk-client"},a.a.createElement(v.a,{variant:"h5"},"Agurk")),a.a.createElement(y.a,{color:"inherit",target:"_blank",href:"https://github.com/SimonMueller/agurk-server/blob/master/README.md#rules"},a.a.createElement(v.a,{variant:"body1"},"Rules")))))}var Mt=Object(u.b)((function(e){return{isAuthenticated:e.authentication.isAuthenticated}}))((function(e){var t=e.isAuthenticated;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Bt,null),a.a.createElement("main",null,a.a.createElement(E.a,{maxWidth:"md"},a.a.createElement(p.a,{paddingTop:2},t?a.a.createElement(kt,null):a.a.createElement(L,null)))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Pt={subject:"",isAuthenticated:!1,token:"",error:void 0},Yt={players:[],isInGame:!1},xt=Object(o.combineReducers)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTHENTICATE_WITH_TOKEN":return Object(F.a)({},e,{subject:t.subject,isAuthenticated:!0,token:t.token,error:void 0});case"AUTHENTICATION_ERROR":return Object(F.a)({},e,{error:t.message});case"UNAUTHENTICATE_WITH_ERROR":return Object(F.a)({},e,{},Pt,{error:t.message});default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PLAYER_ID":return Object(F.a)({},e,{playerId:t.playerId});case"START_GAME":return Object(F.a)({},e,{stage:Ce.START,players:t.playerIds.map((function(e){return Object(F.a)({},Pe,{id:e})}))});case"END_GAME_SUCCESS":return Object(F.a)({},e,{stage:Ce.END,players:e.players.map((function(e){return Object(F.a)({},e,{isGameWinner:e.id===t.winner})}))});case"RESET_GAME":return Object(F.a)({},e,{players:e.players.map((function(e){return Object(F.a)({},e,{},Pe)}))},Me,{playerId:e.playerId});case"END_GAME_ERROR":return Object(F.a)({},e,{stage:Ce.END});case"SET_CARDS_IN_HAND":return Object(F.a)({},e,{cardsInHand:t.cards});case"ADD_PLAYER_TURN":return Object(F.a)({},e,{validatedTurns:[].concat(Object(_e.a)(e.validatedTurns),[t.turn]),players:e.players.map((function(e){return Object(F.a)({},e,{isServerRequestingCards:t.turn.playerId!==e.id&&e.isServerRequestingCards})})),cardsInHand:Le(t.turn,e.playerId)?ke(e.cardsInHand,t.turn):e.cardsInHand});case"START_ROUND":return Object(F.a)({},e,{stage:Ce.BEFORE_CYCLE});case"END_ROUND":return Object(F.a)({},e,{stage:Ce.BETWEEN_ROUNDS,players:e.players.map((function(e){return Object(F.a)({},e,{penalties:[].concat(Object(_e.a)(e.penalties),Object(_e.a)(Ie(t.penalties,e.id))),isOut:we(t.outPlayers,e.id),isRoundWinner:e.id===t.winner})}))});case"START_CYCLE":return Object(F.a)({},e,{players:e.players.map((function(e){return Object(F.a)({},e,{order:Be(t.orderedPlayerIds,e)})})),stage:Ce.IN_CYCLE,validatedTurns:[],isLastCycleOfRound:t.isLastOfRound});case"END_CYCLE":return Object(F.a)({},e,{stage:Ce.BETWEEN_CYCLES,players:e.players.map((function(e){return Object(F.a)({},e,{isCycleHighestTurnPlayer:Ne(t.highestTurnPlayerIds,e.id),isOut:we(t.outPlayers,e.id),outReason:De(t.outPlayers,e.id)})}))});case"REQUEST_CARDS":return Object(F.a)({},e,{turnTimeoutInMillis:t.turnTimeoutInMillis,turnRetriesLeft:t.turnRetriesLeft});case"START_PLAYER_TURN":return Object(F.a)({},e,{players:e.players.map((function(e){return Object(F.a)({},e,{isServerRequestingCards:t.playerId===e.id})}))});default:return e}},lobby:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOBBY_PLAYERS":return Object(F.a)({},e,{players:t.playerIds});case"SET_IS_IN_GAME":return Object(F.a)({},e,{isInGame:t.isInGame});default:return e}}}),Ut=(n(98),n(71)),Gt=n(145),Ht=Object(Ut.a)({typography:{h1:{fontSize:"3rem"},h2:{fontSize:"2.25rem"},h3:{fontSize:"1.75rem"},h4:{fontSize:"1.5rem"},h5:{fontSize:"1.25rem"},h6:{fontSize:"1rem"}}}),Wt=Object(Gt.a)(Ht),zt=Object(o.createStore)(xt,Object(s.composeWithDevTools)(Object(o.applyMiddleware)(l.a)));c.a.render(a.a.createElement(u.a,{store:zt},a.a.createElement(f.a,{theme:Wt},a.a.createElement(m.a,{theme:Wt},a.a.createElement(d.b,{injectFirst:!0},a.a.createElement(Mt,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[82,1,2]]]);
//# sourceMappingURL=main.feed2cff.chunk.js.map